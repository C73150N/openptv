language: python
matrix:
  include:
  - sudo: required
    services:
    - docker
    env:
    - CIBW_SKIP="*manylinux1_i686* cp34-*"
    - CIBW_BEFORE_BUILD="pip install -r requirements.txt && python setup.py prepare
      --liboptv-dir liboptv-src"
    - PIP=pip
  - os: osx
    language: generic
    env:
    - PIP=pip2
    - CIBW_BEFORE_BUILD="cd py_bind && pip install -r requirements.txt && python setup.py
      prepare --liboptv-dir liboptv-src"
    - CIBW_SKIP=cp34-*
script:
- "$PIP install cibuildwheel==0.10.2"
- cp -R liboptv py_bind/liboptv-src
- cibuildwheel py_bind --output-dir wheelhouse
before_deploy: echo 'start deploy'
deploy:
  provider: s3
  access_key_id: "AKIA2TAFTQ25RF5U6CTR"
  secret_access_key:
    secure: "bfrPWMP4S01MF9wUWpAqoYnAAda17+Iwlx3G3tZ9mp5WQqqNh0zt6x6T8rvVHmLwtZlwnmUIdFEfT50e8uTpMXv13wU3K24FtFXhMgFQXfeEr7cPmbqslUQJDbWzlh6VnPBTKX7Gr1dpH5CqMJCLA28gitZ7RW7ejgyTktxB82swk0Zl/HrpwJ3PCKLOoX8BBx/B3TOMf1U4EJpqWuylkbr+0kvDeWBG5hJ1usfzPWbOYheRD16gbzcLhKfv4+AW01ZG+aOaLayOY0VMcPVNfzLZ8EBALfUkq6Na41zRvWsCmjNLFj1nUkRq2+n2bfzTntGaYYVvJ4itOsSV92zK4B1oNHuyhZOiT8iDq0u1SDjhmVPAMDZt3oOAFx8COqnm8K27K7DGDZTrbA0KpkfpsXb9FnyVI/SxhmmMeJTNdxU22Q5eIzN+COmVwfN6J35V1iL7rkD1WN7kVDL8DlFdld36jYqg6wqEdyjljAmAn9Q13uWV/q4fzVdDnhCn/YqNlSBCpyOk40e/aVa2BN7C4ADh/o5pxjK0ifC8smYzQLTwiu0GR31JyjLh/KwfxpBszg85pTGcA9/FDJrjjUAAofGjd5wNiLcFIrjfM+gC5ZQvTrQKtocLaapHbOX/h50+7h5RiaEEoazyWaE9nTaL2jQoBgQgbYakemBT56YYIvc="
  bucket: "optv"
  acl: public_read_write
  skip_cleanup: true
  on:
    branch: travis
